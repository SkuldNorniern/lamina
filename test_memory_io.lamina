# Example demonstrating pointer operations with I/O
fn @main() -> void {
  entry:
    # Print "Storing value..." message
    %s = writebyte 83  # 'S'
    %t = writebyte 116 # 't'
    %o = writebyte 111 # 'o'
    %r = writebyte 114 # 'r'
    %i = writebyte 105 # 'i'
    %n = writebyte 110 # 'n'
    %g = writebyte 103 # 'g'
    %space1 = writebyte 32 # ' '

    %v = writebyte 118 # 'v'
    %a = writebyte 97  # 'a'
    %l = writebyte 108 # 'l'
    %u = writebyte 117 # 'u'
    %e = writebyte 101 # 'e'
    %dot1 = writebyte 46 # '.'
    %dot2 = writebyte 46 # '.'
    %dot3 = writebyte 46 # '.'
    %nl1 = writebyte 10 # newline

    # Allocate a buffer to store our data
    %buffer = alloc.stack i32

    # Store a value (ASCII 'A' = 65) at the buffer location
    store.i32 %buffer, 65

    # Load the value back from the buffer
    %loaded_value = load.i32 %buffer

    # Print "Loaded value: " message
    %l2 = writebyte 76  # 'L'
    %o2 = writebyte 111 # 'o'
    %a2 = writebyte 97  # 'a'
    %d = writebyte 100  # 'd'
    %e2 = writebyte 101 # 'e'
    %d2 = writebyte 100 # 'd'
    %space2 = writebyte 32 # ' '

    %v2 = writebyte 118 # 'v'
    %a3 = writebyte 97  # 'a'
    %l3 = writebyte 108 # 'l'
    %u2 = writebyte 117 # 'u'
    %e3 = writebyte 101 # 'e'
    %colon = writebyte 58 # ':'
    %space3 = writebyte 32 # ' '

    # Use writeptr to write the value stored at the buffer to stdout
    # This will output the raw binary value (65 = 'A')
    %write_result = writeptr %buffer

    # Print newline
    %nl2 = writebyte 10

    # For comparison, let's also store and load different values
    %buffer2 = alloc.stack i8

    # Store ASCII 'B' (66) in the i8 buffer
    store.i8 %buffer2, 66

    # Load and write the second value
    %write_result2 = writeptr %buffer2

    # Print final newline
    %nl3 = writebyte 10

    ret.void
}
